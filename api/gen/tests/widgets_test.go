// Code generated by https://github.com/defany/govk. DO NOT EDIT.

package tests

import (
	"encoding/json"
	"github.com/defany/govk/api/gen/models"
	"github.com/defany/govk/api/gen/widgets"
	"github.com/defany/govk/pkg/random"
	"github.com/defany/govk/vk"
	"github.com/stretchr/testify/assert"
	"github.com/stretchr/testify/require"
	"testing"
)

func fillRandomlyWidgetsGetCommentsRequest(r *requests.WidgetsGetCommentsRequest) {
	r.WithWidgetApiId(random.RandInt())
	r.WithUrl(random.RandString())
	r.WithPageId(random.RandString())
	r.WithOrder(random.RandString())
	Fields := new([]models.UsersFields)
	lFields := random.RandIntn(random.MaxArrayLength + 1)
	*Fields = make([]models.UsersFields, lFields)
	for i0 := 0; i0 < lFields; i0++ {
		fillRandomlyUsersFields(&(*Fields)[i0])
	}
	r.WithFields(*Fields)
	r.WithOffset(random.RandInt())
	r.WithCount(random.RandInt())
}

func TestVKWidgetsGetCommentsSuccess(t *testing.T) {
	params := requests.NewWidgetsGetCommentsRequest()
	fillRandomlyWidgetsGetCommentsRequest(&params)
	var expected models.WidgetsGetCommentsResponse
	fillRandomlyWidgetsGetCommentsResponse(&expected)
	expectedJSON, err := json.Marshal(expected)
	require.NoError(t, err)
	token := random.RandString()
	vk, err := govk.NewVK(token)
	assert.NoError(t, err)
	vk.Api.WithHTTP(NewTestClient(t, "widgets.getComments", params.Params(), expectedJSON))
	resp, err := vk.Api.Widgets.WidgetsGetComments(params)
	assert.EqualValues(t, expected, resp)
	assert.NoError(t, err)
}

func fillRandomlyWidgetsGetPagesRequest(r *requests.WidgetsGetPagesRequest) {
	r.WithWidgetApiId(random.RandInt())
	r.WithOrder(random.RandString())
	r.WithPeriod(random.RandString())
	r.WithOffset(random.RandInt())
	r.WithCount(random.RandInt())
}

func TestVKWidgetsGetPagesSuccess(t *testing.T) {
	params := requests.NewWidgetsGetPagesRequest()
	fillRandomlyWidgetsGetPagesRequest(&params)
	var expected models.WidgetsGetPagesResponse
	fillRandomlyWidgetsGetPagesResponse(&expected)
	expectedJSON, err := json.Marshal(expected)
	require.NoError(t, err)
	token := random.RandString()
	vk, err := govk.NewVK(token)
	assert.NoError(t, err)
	vk.Api.WithHTTP(NewTestClient(t, "widgets.getPages", params.Params(), expectedJSON))
	resp, err := vk.Api.Widgets.WidgetsGetPages(params)
	assert.EqualValues(t, expected, resp)
	assert.NoError(t, err)
}
